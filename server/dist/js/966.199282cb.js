"use strict";(self["webpackChunkstronger_tetris"]=self["webpackChunkstronger_tetris"]||[]).push([[966],{7966:(e,t,s)=>{s.r(t),s.d(t,{default:()=>ie});s(702);var o=s(9835);const a={class:"col-4"},r={class:"col-auto"},n={class:"col-4"},l={key:1,class:"custom-area row justify-between"},i={class:"col-4"},m={class:"col-auto"},c={class:"col-4"};function d(e,t,s,d,u,g){const w=(0,o.up)("GameDialog"),h=(0,o.up)("GameInfo"),p=(0,o.up)("GameSpectres"),y=(0,o.up)("TetrisBoard"),f=(0,o.up)("GameControls"),v=(0,o.up)("q-page"),k=(0,o.Q2)("touch-swipe");return(0,o.wg)(),(0,o.j4)(v,{style:{"min-height":"0px"}},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{isMaster:e.master===e.player},null,8,["isMaster"]),e.gameOn?(0,o.wy)(((0,o.wg)(),(0,o.iD)("div",{key:0,onClick:t[0]||(t[0]=(...t)=>e.handleUp&&e.handleUp(...t)),class:"custom-area row justify-between"},[(0,o._)("div",a,[(0,o.Wm)(h),(0,o.Wm)(p)]),(0,o._)("div",r,[(0,o.Wm)(y)]),(0,o._)("div",n,[(0,o.Wm)(f)])])),[[k,e.handleRight,void 0,{mouse:!0,right:!0}],[k,e.handleLeft,void 0,{mouse:!0,left:!0}],[k,e.handleSpace,void 0,{mouse:!0,down:!0}],[k,e.handleSpace,void 0,{mouse:!0,up:!0}]]):((0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("div",i,[(0,o.Wm)(h),(0,o.Wm)(p)]),(0,o._)("div",m,[(0,o.Wm)(y)]),(0,o._)("div",c,[(0,o.Wm)(f)])]))])),_:1})}var u=s(6970);function g(e,t,s,a,r,n){const l=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(l,{flat:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.tetris,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:"row"+t,class:"row justify-center"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:"col"+t,class:(0,u.C_)(["col case",n.getColor(e)])},null,2)))),128))])))),128))])),_:1})}const w={name:"TetrisBoard",computed:{tetris(){return this.$store.getters["game/getTetris"]}},methods:{getColor(e){return{shadow:-2===e,blocked:-1===e,empty:0===e,turquoise:1===e,blue:2===e,orange:3===e,yellow:4===e,green:5===e,purple:6===e,red:7===e}}}};var h=s(1639),p=s(4458),y=s(9984),f=s.n(y);const v=(0,h.Z)(w,[["render",g],["__scopeId","data-v-009ee4c2"]]),k=v;f()(w,"components",{QCard:p.Z});const b={class:"row q-my-md"},_=(0,o._)("span",{class:"text-bold"},"Player : ",-1),q={class:"row q-my-md"},$=(0,o._)("span",{class:"text-bold"},"Master : ",-1),D={class:"row q-my-md"},C=(0,o._)("span",{class:"text-bold"},"Piece shadow :",-1),G={key:0,class:"row q-my-md"},S=(0,o._)("span",{class:"text-bold"},"Spectres details :",-1),Z={key:1,class:"row q-my-md"},W=(0,o._)("span",{class:"text-bold"},"Game paused : ",-1),j=(0,o.Uk)(" Waiting for master "),P=[W,j];function U(e,t,s,a,r,n){const l=(0,o.up)("q-toggle"),i=(0,o.up)("q-card-section"),m=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(m,{flat:""},{default:(0,o.w5)((()=>[(0,o.Wm)(i,null,{default:(0,o.w5)((()=>[(0,o._)("div",b,[_,(0,o.Uk)((0,u.zw)(n.playerName),1)]),(0,o._)("div",q,[$,(0,o.Uk)((0,u.zw)(n.master),1)]),(0,o._)("div",D,[C,(0,o.Wm)(l,{color:"secondary",modelValue:r.shadow,"onUpdate:modelValue":t[0]||(t[0]=e=>r.shadow=e)},null,8,["modelValue"])]),n.playerName===n.master?((0,o.wg)(),(0,o.iD)("div",G,[S,(0,o.Wm)(l,{color:"secondary",modelValue:r.details,"onUpdate:modelValue":t[1]||(t[1]=e=>r.details=e)},null,8,["modelValue"])])):(0,o.kq)("",!0),n.gamePaused?((0,o.wg)(),(0,o.iD)("div",Z,P)):(0,o.kq)("",!0)])),_:1})])),_:1})}const Q={name:"GameInfo",data(){return{details:!1,shadow:!0}},computed:{gamePaused(){return this.$store.getters["game/getGamePaused"]},room(){return this.$store.getters["game/getRoomName"]},playerName(){return this.$store.getters["game/getPlayerName"]},master(){return this.$store.getters["game/getMaster"]}},watch:{details(){this.$socket.emit("colors",this.details)},shadow(){this.$socket.emit("ghost",this.shadow)}}};var R=s(3190),A=s(3175);const O=(0,h.Z)(Q,[["render",U]]),M=O;function L(e,t,s,a,r,n){const l=(0,o.up)("q-table");return(0,o.wg)(),(0,o.j4)(l,{flat:"",color:"primary",columns:r.columns,rows:r.rows,"table-header-class":"text-primary","hide-bottom":""},null,8,["columns","rows"])}f()(Q,"components",{QCard:p.Z,QCardSection:R.Z,QToggle:A.Z});const T={name:"GameControls",data(){return{columns:[{name:"controls",label:"Controls",field:"controls",align:"left"},{name:"web",label:"Web",field:"web",align:"left"},{name:"mobile",label:"Mobile",field:"mobile",align:"left"}],rows:[{controls:"Rotate",web:"Arrow Up",mobile:"Tap"},{controls:"Move L/R",web:"Arrow L/R",mobile:"Swipe L/R"},{controls:"Move Down",web:"Arrow Down",mobile:"Swipe Down"},{controls:"Jump Down",web:"Space Bar",mobile:""}]}}};var V=s(1811);const I=(0,h.Z)(T,[["render",L],["__scopeId","data-v-2736589c"]]),x=I;function N(e,t,s,a,r,n){const l=(0,o.up)("q-card");return(0,o.wg)(),(0,o.j4)(l,{class:"row justify-start",flat:""},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.spectres,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{class:"q-ma-sm",key:"tetris"+t},[(0,o.Uk)((0,u.zw)(t)+" ",1),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:"row"+t,class:"row"},[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(e,((e,t)=>((0,o.wg)(),(0,o.iD)("div",{key:"col"+t,class:(0,u.C_)(["col case",n.getColor(e)])},null,2)))),128))])))),128))])))),128))])),_:1})}f()(T,"components",{QTable:V.Z});const B={name:"GameSpectres",computed:{spectres(){return this.$store.getters["game/getSpectres"]}},methods:{getColor(e){return{shadow:-2===e,blocked:-1===e,empty:0===e,turquoise:1===e,blue:2===e,orange:3===e,yellow:4===e,green:5===e,purple:6===e,red:7===e}}}},H=(0,h.Z)(B,[["render",N],["__scopeId","data-v-530c060f"]]),Y=H;f()(B,"components",{QCard:p.Z});const z={key:0,class:"q-ml-sm"},E=(0,o._)("div",{class:"q-ml-sm"}," Game ready !",-1),K={class:"q-ml-sm"};function J(e,t,s,a,r,n){const l=(0,o.up)("q-card-section"),i=(0,o.up)("q-btn"),m=(0,o.up)("q-card-actions"),c=(0,o.up)("q-card"),d=(0,o.up)("q-dialog");return(0,o.wg)(),(0,o.j4)(d,{modelValue:n.show,"onUpdate:modelValue":t[3]||(t[3]=e=>n.show=e),persistent:""},{default:(0,o.w5)((()=>[(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[(0,o.Wm)(l,{class:"row items-center"},{default:(0,o.w5)((()=>[n.winner?((0,o.wg)(),(0,o.iD)("div",z," The winner is "+(0,u.zw)(n.winner)+" !",1)):((0,o.wg)(),(0,o.iD)(o.HY,{key:1},[E,(0,o._)("div",K,(0,u.zw)(n.spectres.length+1)+" player in the room ",1)],64))])),_:1}),(0,o.Wm)(m,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(i,{flat:"",label:"Quit room",color:"primary",onClick:t[0]||(t[0]=e=>n.quit())}),n.winner&&s.isMaster?((0,o.wg)(),(0,o.j4)(i,{key:0,flat:"",label:"Start a new game!",color:"primary",onClick:t[1]||(t[1]=e=>this.$socket.emit("restart"))})):(0,o.kq)("",!0),!n.winner&&s.isMaster?((0,o.wg)(),(0,o.j4)(i,{key:1,flat:"",label:"Start game!",color:"primary",onClick:t[2]||(t[2]=e=>this.$socket.emit("start"))})):(0,o.kq)("",!0)])),_:1})])),_:1})])),_:1},8,["modelValue"])}const F={name:"GameDialog",props:{isMaster:Boolean},computed:{gameOn(){return this.$store.getters["game/getGameOn"]},show(){return!this.gameOn},winner(){return this.$store.getters["game/getWinner"]},spectres(){return Object.keys(this.$store.getters["game/getSpectres"])}},methods:{quit(){this.$store.dispatch("game/quit"),this.$store.dispatch("error/clear"),this.$socket.emit("quit")}}};var X=s(7743),ee=s(1821),te=s(4455);const se=(0,h.Z)(F,[["render",J]]),oe=se;f()(F,"components",{QDialog:X.Z,QCard:p.Z,QCardSection:R.Z,QCardActions:ee.Z,QBtn:te.Z});const ae=(0,o.aZ)({name:"GamePage",components:{TetrisBoard:k,GameInfo:M,GameControls:x,GameSpectres:Y,GameDialog:oe},created(){window.addEventListener("keydown",(e=>{["Space","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.code)&&(e.preventDefault(),this.keyEvent(e))}),!1)},beforeUnmount(){window.removeEventListener("keydown",this.keyEvent)},computed:{gameOn(){return this.$store.getters["game/getGameOn"]},gamePaused(){return this.$store.getters["game/getGamePaused"]},room(){return this.$store.getters["game/getRoomName"]},player(){return this.$store.getters["game/getPlayerName"]},master(){return this.$store.getters["game/getMaster"]},isInGame(){return this.room.length>0&&this.player.length>0},route(){const e=this.$route.params.room,t=this.$route.params.player;return{room:e,player:t}}},methods:{joinRoom(e,t){if(0===this.room.length&&e&&t&&e.length>0&&t.length>0){const s={room_name:e,player_name:t};this.$socket.emit("join_room",s)}},handleSpace(){this.gameOn&&!this.gamePaused&&this.$socket.emit("move","space")},handleDown(){this.gameOn&&!this.gamePaused&&this.$socket.emit("move","down")},handleUp(){this.gameOn&&!this.gamePaused&&this.$socket.emit("move","rotate")},handleLeft(){this.gameOn&&!this.gamePaused&&this.$socket.emit("move","left")},handleRight(){this.gameOn&&!this.gamePaused&&this.$socket.emit("move","right")},keyEvent(e){"Space"===e.code&&this.handleSpace(),"ArrowDown"===e.code&&this.handleDown(),"ArrowUp"===e.code&&this.handleUp(),"ArrowLeft"===e.code&&this.handleLeft(),"ArrowRight"===e.code&&this.handleRight()}},watch:{isInGame:{immediate:!0,handler(e){e||this.$router.push("/")}},route:{immediate:!0,handler(e){this.joinRoom(e.room,e.player)}}}});var re=s(9885),ne=s(5574);const le=(0,h.Z)(ae,[["render",d]]),ie=le;f()(ae,"components",{QPage:re.Z}),f()(ae,"directives",{TouchSwipe:ne.Z})}}]);